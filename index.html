<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analizzatore Cromatico</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header>
        <h1>Analizzatore Cromatico</h1>
    </header>

    <main>
        <div class="spazi-container">
            <!-- Spazio di Lavoro 1 -->
            <div class="spazio" id="spazio1">
                <h2>Spazio 1</h2>
                <div class="controls">
                    <label><input type="radio" name="source1" value="file" checked> File</label>
                    <label><input type="radio" name="source1" value="url"> URL</label>
                    <label><input type="radio" name="source1" value="canvas"> Canvas</label>
                    <label><input type="radio" name="source1" value="color"> Colore</label>
                </div>
                
                <div class="input-area">
                    <div class="input-wrapper" data-source="file" data-space="1">
                        <input type="file" accept="image/*">
                    </div>
                    <div class="input-wrapper" data-source="url" data-space="1" style="display: none;">
                        <input type="url" placeholder="https://example.com/image.png">
                        <button>Carica</button>
                    </div>
                    <div class="input-wrapper" data-source="canvas" data-space="1" style="display: none;">
                        <button class="canvas-open-btn">Apri Canvas</button>
                    </div>
                    <div class="input-wrapper" data-source="color" data-space="1" style="display: none;">
                        <div class="color-palette">
                            <div class="palette-swatch" data-color="#ef4444" title="Red 500"></div>
                            <div class="palette-swatch" data-color="#f97316" title="Orange 500"></div>
                            <div class="palette-swatch" data-color="#f59e0b" title="Amber 500"></div>
                            <div class="palette-swatch" data-color="#eab308" title="Yellow 500"></div>
                            <div class="palette-swatch" data-color="#84cc16" title="Lime 500"></div>
                            <div class="palette-swatch" data-color="#22c55e" title="Green 500"></div>
                            <div class="palette-swatch" data-color="#10b981" title="Emerald 500"></div>
                            <div class="palette-swatch" data-color="#14b8a6" title="Teal 500"></div>
                            <div class="palette-swatch" data-color="#06b6d4" title="Cyan 500"></div>
                            <div class="palette-swatch" data-color="#0ea5e9" title="Sky 500"></div>
                            <div class="palette-swatch" data-color="#3b82f6" title="Blue 500"></div>
                            <div class="palette-swatch" data-color="#6366f1" title="Indigo 500"></div>
                            <div class="palette-swatch" data-color="#8b5cf6" title="Violet 500"></div>
                            <div class="palette-swatch" data-color="#a855f7" title="Purple 500"></div>
                            <div class="palette-swatch" data-color="#d946ef" title="Fuchsia 500"></div>
                            <div class="palette-swatch" data-color="#ec4899" title="Pink 500"></div>
                            <div class="palette-swatch" data-color="#f43f5e" title="Rose 500"></div>
                            <div class="palette-swatch" data-color="#78716c" title="Stone 500"></div>
                            <div class="palette-swatch" data-color="#fca5a5" title="Red 300"></div>
                            <div class="palette-swatch" data-color="#fdba74" title="Orange 300"></div>
                            <div class="palette-swatch" data-color="#fcd34d" title="Amber 300"></div>
                            <div class="palette-swatch" data-color="#bef264" title="Lime 300"></div>
                            <div class="palette-swatch" data-color="#86efac" title="Green 300"></div>
                            <div class="palette-swatch" data-color="#6ee7b7" title="Emerald 300"></div>
                            <div class="palette-swatch" data-color="#99f6e4" title="Teal 300"></div>
                            <div class="palette-swatch" data-color="#7dd3fc" title="Sky 300"></div>
                            <div class="palette-swatch" data-color="#93c5fd" title="Blue 300"></div>
                            <div class="palette-swatch" data-color="#a5b4fc" title="Indigo 300"></div>
                            <div class="palette-swatch" data-color="#c4b5fd" title="Violet 300"></div>
                            <div class="palette-swatch" data-color="#f0abfc" title="Fuchsia 300"></div>
                            <div class="palette-swatch" data-color="#f9a8d4" title="Pink 300"></div>
                            <div class="palette-swatch" data-color="#a3a3a3" title="Neutral 400"></div>
                            <div class="palette-swatch" data-color="#b91c1c" title="Red 700"></div>
                            <div class="palette-swatch" data-color="#c2410c" title="Orange 700"></div>
                            <div class="palette-swatch" data-color="#15803d" title="Green 700"></div>
                            <div class="palette-swatch" data-color="#1d4ed8" title="Blue 700"></div>
                            
                            <div class="custom-color-btn" title="Colore personalizzato">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm0 1.5a8.25 8.25 0 0 1 8.25 8.25c0 1.92-.663 3.68-1.755 5.063l-6.495-6.495a.75.75 0 0 0-1.06 1.06l6.495 6.495A8.25 8.25 0 0 1 3.75 12C3.75 7.44 7.44 3.75 12 3.75Zm0 16.5a8.217 8.217 0 0 0 5.063-1.755l-6.495-6.495a.75.75 0 0 0-1.06-1.06L3.44 17.313A8.217 8.217 0 0 0 12 20.25Z" /></svg>
                                <input type="color" value="#ef4444" class="color-picker-input">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="preview-container">
                    <div class="placeholder">Nessuna sorgente selezionata</div>
                    <img src="" alt="Anteprima Spazio 1" class="preview-image" style="display:none;">
                    <div class="preview-color" style="display:none;"></div>
                </div>

                <div class="results">
                    <table class="results-table">
                        <tbody>
                            <tr class="avg-row">
                                <th scope="row">Colore Medio</th>
                                <td data-label="Box" class="result-box-cell"><div class="result-box"></div></td>
                                <td data-label="HEX" class="result-hex">-</td>
                                <td data-label="RGB" class="result-rgb">-</td>
                            </tr>
                            <tr class="mode-row">
                                <th scope="row">Colore Moda</th>
                                <td data-label="Box" class="result-box-cell"><div class="result-box"></div></td>
                                <td data-label="HEX" class="result-hex">-</td>
                                <td data-label="RGB" class="result-rgb">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Spazio di Lavoro 2 (con la stessa palette estesa) -->
            <div class="spazio" id="spazio2">
                <h2>Spazio 2</h2>
                 <div class="controls">
                    <label><input type="radio" name="source2" value="file" checked> File</label>
                    <label><input type="radio" name="source2" value="url"> URL</label>
                    <label><input type="radio" name="source2" value="canvas"> Canvas</label>
                    <label><input type="radio" name="source2" value="color"> Colore</label>
                </div>
                
                <div class="input-area">
                    <div class="input-wrapper" data-source="file" data-space="2">
                        <input type="file" accept="image/*">
                    </div>
                    <div class="input-wrapper" data-source="url" data-space="2" style="display: none;">
                        <input type="url" placeholder="https://example.com/image.png">
                        <button>Carica</button>
                    </div>
                    <div class="input-wrapper" data-source="canvas" data-space="2" style="display: none;">
                         <button class="canvas-open-btn">Apri Canvas</button>
                    </div>
                    <div class="input-wrapper" data-source="color" data-space="2" style="display: none;">
                        <div class="color-palette">
                            <div class="palette-swatch" data-color="#ef4444" title="Red 500"></div>
                            <div class="palette-swatch" data-color="#f97316" title="Orange 500"></div>
                            <div class="palette-swatch" data-color="#f59e0b" title="Amber 500"></div>
                            <div class="palette-swatch" data-color="#eab308" title="Yellow 500"></div>
                            <div class="palette-swatch" data-color="#84cc16" title="Lime 500"></div>
                            <div class="palette-swatch" data-color="#22c55e" title="Green 500"></div>
                            <div class="palette-swatch" data-color="#10b981" title="Emerald 500"></div>
                            <div class="palette-swatch" data-color="#14b8a6" title="Teal 500"></div>
                            <div class="palette-swatch" data-color="#06b6d4" title="Cyan 500"></div>
                            <div class="palette-swatch" data-color="#0ea5e9" title="Sky 500"></div>
                            <div class="palette-swatch" data-color="#3b82f6" title="Blue 500"></div>
                            <div class="palette-swatch" data-color="#6366f1" title="Indigo 500"></div>
                            <div class="palette-swatch" data-color="#8b5cf6" title="Violet 500"></div>
                            <div class="palette-swatch" data-color="#a855f7" title="Purple 500"></div>
                            <div class="palette-swatch" data-color="#d946ef" title="Fuchsia 500"></div>
                            <div class="palette-swatch" data-color="#ec4899" title="Pink 500"></div>
                            <div class="palette-swatch" data-color="#f43f5e" title="Rose 500"></div>
                            <div class="palette-swatch" data-color="#78716c" title="Stone 500"></div>
                            <div class="palette-swatch" data-color="#fca5a5" title="Red 300"></div>
                            <div class="palette-swatch" data-color="#fdba74" title="Orange 300"></div>
                            <div class="palette-swatch" data-color="#fcd34d" title="Amber 300"></div>
                            <div class="palette-swatch" data-color="#bef264" title="Lime 300"></div>
                            <div class="palette-swatch" data-color="#86efac" title="Green 300"></div>
                            <div class="palette-swatch" data-color="#6ee7b7" title="Emerald 300"></div>
                            <div class="palette-swatch" data-color="#99f6e4" title="Teal 300"></div>
                            <div class="palette-swatch" data-color="#7dd3fc" title="Sky 300"></div>
                            <div class="palette-swatch" data-color="#93c5fd" title="Blue 300"></div>
                            <div class="palette-swatch" data-color="#a5b4fc" title="Indigo 300"></div>
                            <div class="palette-swatch" data-color="#c4b5fd" title="Violet 300"></div>
                            <div class="palette-swatch" data-color="#f0abfc" title="Fuchsia 300"></div>
                            <div class="palette-swatch" data-color="#f9a8d4" title="Pink 300"></div>
                            <div class="palette-swatch" data-color="#a3a3a3" title="Neutral 400"></div>
                            <div class="palette-swatch" data-color="#b91c1c" title="Red 700"></div>
                            <div class="palette-swatch" data-color="#c2410c" title="Orange 700"></div>
                            <div class="palette-swatch" data-color="#15803d" title="Green 700"></div>
                            <div class="palette-swatch" data-color="#1d4ed8" title="Blue 700"></div>
                            
                           <div class="custom-color-btn" title="Colore personalizzato">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm0 1.5a8.25 8.25 0 0 1 8.25 8.25c0 1.92-.663 3.68-1.755 5.063l-6.495-6.495a.75.75 0 0 0-1.06 1.06l6.495 6.495A8.25 8.25 0 0 1 3.75 12C3.75 7.44 7.44 3.75 12 3.75Zm0 16.5a8.217 8.217 0 0 0 5.063-1.755l-6.495-6.495a.75.75 0 0 0-1.06-1.06L3.44 17.313A8.217 8.217 0 0 0 12 20.25Z" /></svg>
                                <input type="color" value="#ef4444" class="color-picker-input">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="preview-container">
                    <div class="placeholder">Nessuna sorgente selezionata</div>
                    <img src="" alt="Anteprima Spazio 2" class="preview-image" style="display:none;">
                    <div class="preview-color" style="display:none;"></div>
                </div>

                <div class="results">
                     <table class="results-table">
                        <tbody>
                            <tr class="avg-row">
                                <th scope="row">Colore Medio</th>
                                <td data-label="Box" class="result-box-cell"><div class="result-box"></div></td>
                                <td data-label="HEX" class="result-hex">-</td>
                                <td data-label="RGB" class="result-rgb">-</td>
                            </tr>
                            <tr class="mode-row">
                                <th scope="row">Colore Moda</th>
                                <td data-label="Box" class="result-box-cell"><div class="result-box"></div></td>
                                <td data-label="HEX" class="result-hex">-</td>
                                <td data-label="RGB" class="result-rgb">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="confronto-container">
            <h3>Confronto tra medie</h3>
            <table class="results-table">
                <tbody>
                    <tr>
                        <th scope="row">Distanza Euclidea</th>
                        <td data-label="Valore" id="dist-value">-</td>
                    </tr>
                     <tr>
                        <th scope="row">Percentuale Distanza</th>
                        <td data-label="%" id="dist-perc">-</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <!-- Modal per il Canvas -->
    <div id="canvas-modal-overlay" style="display: none;">
        <div id="canvas-modal-content">
            <div class="modal-header">
                <h3>Disegna sul Canvas</h3>
                <button id="canvas-close-btn">&times;</button>
            </div>
            <div class="canvas-controls">
                <div class="canvas-palette-container">
                    <label>Colore:</label>
                    <div class="color-palette" id="canvas-color-palette">
                         <div class="palette-swatch" data-color="#ef4444" title="Red 500"></div>
                         <div class="palette-swatch" data-color="#f97316" title="Orange 500"></div>
                         <div class="palette-swatch" data-color="#f59e0b" title="Amber 500"></div>
                         <div class="palette-swatch" data-color="#eab308" title="Yellow 500"></div>
                         <div class="palette-swatch" data-color="#84cc16" title="Lime 500"></div>
                         <div class="palette-swatch" data-color="#22c55e" title="Green 500"></div>
                         <div class="palette-swatch" data-color="#10b981" title="Emerald 500"></div>
                         <div class="palette-swatch" data-color="#14b8a6" title="Teal 500"></div>
                         <div class="palette-swatch" data-color="#06b6d4" title="Cyan 500"></div>
                         <div class="palette-swatch" data-color="#0ea5e9" title="Sky 500"></div>
                         <div class="palette-swatch" data-color="#3b82f6" title="Blue 500"></div>
                         <div class="palette-swatch" data-color="#6366f1" title="Indigo 500"></div>
                         <div class="palette-swatch" data-color="#8b5cf6" title="Violet 500"></div>
                         <div class="palette-swatch" data-color="#a855f7" title="Purple 500"></div>
                         <div class="palette-swatch" data-color="#d946ef" title="Fuchsia 500"></div>
                         <div class="palette-swatch" data-color="#ec4899" title="Pink 500"></div>
                         <div class="palette-swatch" data-color="#f43f5e" title="Rose 500"></div>
                         <div class="palette-swatch" data-color="#78716c" title="Stone 500"></div>
                         <div class="palette-swatch" data-color="#fca5a5" title="Red 300"></div>
                         <div class="palette-swatch" data-color="#fdba74" title="Orange 300"></div>
                         <div class="palette-swatch" data-color="#fcd34d" title="Amber 300"></div>
                         <div class="palette-swatch" data-color="#bef264" title="Lime 300"></div>
                         <div class="palette-swatch" data-color="#86efac" title="Green 300"></div>
                         <div class="palette-swatch" data-color="#6ee7b7" title="Emerald 300"></div>
                         <div class="palette-swatch" data-color="#99f6e4" title="Teal 300"></div>
                         <div class="palette-swatch" data-color="#7dd3fc" title="Sky 300"></div>
                         <div class="palette-swatch" data-color="#93c5fd" title="Blue 300"></div>
                         <div class="palette-swatch" data-color="#a5b4fc" title="Indigo 300"></div>
                         <div class="palette-swatch" data-color="#c4b5fd" title="Violet 300"></div>
                         <div class="palette-swatch" data-color="#f0abfc" title="Fuchsia 300"></div>
                         <div class="palette-swatch" data-color="#f9a8d4" title="Pink 300"></div>
                         <div class="palette-swatch" data-color="#a3a3a3" title="Neutral 400"></div>
                         <div class="palette-swatch" data-color="#b91c1c" title="Red 700"></div>
                         <div class="palette-swatch" data-color="#c2410c" title="Orange 700"></div>
                         <div class="palette-swatch" data-color="#15803d" title="Green 700"></div>
                         <div class="palette-swatch" data-color="#1d4ed8" title="Blue 700"></div>
                         <div class="custom-color-btn" title="Colore personalizzato">
                             <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25Zm0 1.5a8.25 8.25 0 0 1 8.25 8.25c0 1.92-.663 3.68-1.755 5.063l-6.495-6.495a.75.75 0 0 0-1.06 1.06l6.495 6.495A8.25 8.25 0 0 1 3.75 12C3.75 7.44 7.44 3.75 12 3.75Zm0 16.5a8.217 8.217 0 0 0 5.063-1.755l-6.495-6.495a.75.75 0 0 0-1.06-1.06L3.44 17.313A8.217 8.217 0 0 0 12 20.25Z" /></svg>
                             <input type="color" id="canvas-color-input" value="#ef4444">
                        </div>
                    </div>
                </div>
                <div class="brush-size-container">
                    <label for="canvas-brush-size">Spessore:</label>
                    <input type="range" id="canvas-brush-size" min="1" max="50" value="5">
                </div>
            </div>
            <canvas id="canvas"></canvas>
            <div class="modal-footer">
                <button id="canvas-clear-btn">Pulisci</button>
                <button id="canvas-save-btn">Salva e Chiudi</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>